<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>HPXML File Editor</title>
	<style>
		.container {
			max-width: 1200px;
			margin: 0 auto;
			padding: 20px;
		}
		.upload-section {
			border: 2px dashed #ccc;
			padding: 20px;
			text-align: center;
			margin-bottom: 20px;
		}
		.editor-section {
			display: none;
		}
		.form-section {
			margin-bottom: 20px;
			padding: 15px;
			border: 1px solid #ddd;
			border-radius: 5px;
		}
		.form-group {
			margin-bottom: 10px;
		}
		.form-group label {
			display: block;
			margin-bottom: 5px;
			font-weight: bold;
		}
		.form-group input, .form-group select, .form-group textarea {
			width: 100%;
			padding: 8px;
			border: 1px solid #ccc;
			border-radius: 4px;
		}
		.button {
			padding: 10px 20px;
			background-color: #4CAF50;
			color: white;
			border: none;
			cursor: pointer;
			margin: 5px;
			border-radius: 4px;
		}
		.button:hover {
			background-color: #45a049;
		}
		.section-header {
			background-color: #f5f5f5;
			padding: 10px;
			margin-bottom: 15px;
			border-radius: 4px;
		}
	</style>
</head>
<body>
	<div class="container">
		<h1>HPXML File Editor</h1>
		<div class="upload-section">
			<input type="file" id="fileInput" accept=".xml">
			<p>Drag and drop HPXML file or click to select</p>
		</div>

		<div id="hpxmlForm">
			<div class="form-section">
				<h2 class="section-header">XML Transaction Header</h2>
				<div class="form-group">
					<label for="xmlType">XML Type</label>
					<select id="xmlType">
						<option value="BPI-2101">BPI-2101</option>
						<option value="audit">Audit</option>
						<option value="upgrade">Upgrade</option>
					</select>
				</div>
				<div class="form-group">
					<label for="xmlGeneratedBy">Generated By</label>
					<input type="text" id="xmlGeneratedBy">
				</div>
				<div class="form-group">
					<label for="createdDateTime">Created Date/Time</label>
					<input type="datetime-local" id="createdDateTime">
				</div>
			</div>

			<div class="form-section">
				<h2 class="section-header">Building Information</h2>
				<div class="form-group">
					<label for="buildingId">Building ID</label>
					<input type="text" id="buildingId">
				</div>
				<div class="form-group">
					<label for="projectStatus">Project Status</label>
					<select id="projectStatus">
						<option value="audit">Audit</option>
						<option value="proposed workscope">Proposed Workscope</option>
						<option value="approved workscope">Approved Workscope</option>
						<option value="job completion">Job Completion</option>
					</select>
				</div>
			</div>

			<div class="form-section">
				<h2 class="section-header">Customer Details</h2>
				<div class="form-group">
					<label for="firstName">First Name</label>
					<input type="text" id="firstName">
				</div>
				<div class="form-group">
					<label for="lastName">Last Name</label>
					<input type="text" id="lastName">
				</div>
			</div>

			<div class="form-section">
				<h2 class="section-header">Site Address</h2>
				<div class="form-group">
					<label for="address1">Address Line 1</label>
					<input type="text" id="address1">
				</div>
				<div class="form-group">
					<label for="address2">Address Line 2</label>
					<input type="text" id="address2">
				</div>
				<div class="form-group">
					<label for="city">City</label>
					<input type="text" id="city">
				</div>
				<div class="form-group">
					<label for="state">State</label>
					<input type="text" id="state">
				</div>
				<div class="form-group">
					<label for="zipCode">ZIP Code</label>
					<input type="text" id="zipCode">
				</div>
			</div>

			<div class="form-section">
				<h2 class="section-header">Building Systems</h2>
				<div class="form-group">
					<label for="hvacSystem">HVAC System Type</label>
					<select id="hvacSystem">
						<option value="furnace">Furnace</option>
						<option value="central-ac">Central Air Conditioner</option>
						<option value="heat-pump">Heat Pump</option>
					</select>
				</div>
				<div class="form-group">
					<label for="waterHeater">Water Heater Type</label>
					<select id="waterHeater">
						<option value="storage">Storage Water Heater</option>
						<option value="tankless">Tankless Water Heater</option>
						<option value="heat-pump">Heat Pump Water Heater</option>
					</select>
				</div>
			</div>

			<div class="form-section">
				<h2 class="section-header">Air Infiltration</h2>
				<div class="form-group">
					<label for="blowerDoorTest">Blower Door Test Type</label>
					<select id="blowerDoorTest">
						<option value="depressurization">Depressurization</option>
						<option value="pressurization">Pressurization</option>
					</select>
				</div>
				<div class="form-group">
					<label for="housePressure">House Pressure (Pa)</label>
					<input type="number" id="housePressure">
				</div>
				<div class="form-group">
					<label for="airLeakage">Air Leakage (CFM)</label>
					<input type="number" id="airLeakage">
				</div>
			</div>

			<button class="button" onclick="generateXML()">Generate HPXML</button>
			<button class="button" onclick="validateXML()">Validate HPXML</button>
			<button class="button" onclick="downloadXML()">Download XML</button>
		</div>
	</div>

	<script>
		const fileInput = document.getElementById('fileInput');
		const xmlEditor = document.getElementById('xmlEditor');
		const editorSection = document.getElementById('editorSection');

		fileInput.addEventListener('change', handleFileSelect);

		function handleFileSelect(event) {
			const file = event.target.files[0];
			if (file) {
				const reader = new FileReader();
				reader.onload = function(e) {
					xmlEditor.value = e.target.result;
					editorSection.style.display = 'block';
				};
				reader.readAsText(file);
			}
		}

		function saveChanges() {
			localStorage.setItem('hpxmlContent', xmlEditor.value);
			alert('Changes saved!');
		}

		function validateXML() {
			try {
				const parser = new DOMParser();
				const xmlDoc = parser.parseFromString(xmlEditor.value, 'text/xml');
				if (xmlDoc.getElementsByTagName('parsererror').length > 0) {
					throw new Error('Invalid XML');
				}
				// Add HPXML-specific validation here
				alert('XML is valid!');
			} catch (error) {
				alert('Invalid XML: ' + error.message);
			}
		}

		function downloadXML() {
			const blob = new Blob([xmlEditor.value], {type: 'text/xml'});
			const url = window.URL.createObjectURL(blob);
			const a = document.createElement('a');
			a.href = url;
			a.download = 'hpxml_file.xml';
			a.click();
			window.URL.revokeObjectURL(url);
		}
	</script>
</body>
</html>
