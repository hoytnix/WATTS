<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>HPXML File Editor</title>
	<style>
		.container {
			max-width: 1200px;
			margin: 0 auto;
			padding: 20px;
		}
		.upload-section {
			border: 2px dashed #ccc;
			padding: 20px;
			text-align: center;
			margin-bottom: 20px;
		}
		.editor-section {
			display: none;
		}
		.form-group {
			margin-bottom: 15px;
			padding: 10px;
			border: 1px solid #ddd;
		}
		.form-group label {
			display: block;
			margin-bottom: 5px;
			font-weight: bold;
		}
		.form-group input, .form-group select {
			width: 100%;
			padding: 8px;
			margin-bottom: 5px;
		}
		.section-header {
			background: #f5f5f5;
			padding: 10px;
			margin: 10px 0;
			font-weight: bold;
		}
		.button {
			padding: 10px 20px;
			background-color: #4CAF50;
			color: white;
			border: none;
			cursor: pointer;
			margin: 5px;
		}
		.button:hover {
			background-color: #45a049;
		}
	</style>
</head>
<body>
	<div class="container">
		<h1>HPXML File Editor</h1>
		<div class="upload-section">
			<input type="file" id="fileInput" accept=".xml">
			<p>Drag and drop HPXML file or click to select</p>
		</div>
		<div class="editor-section" id="editorSection">
			<div class="section-header">XML Transaction Header</div>
			<div class="form-group">
				<label for="xmlType">XML Type</label>
				<select id="xmlType">
					<option value="BPI-2101">BPI-2101</option>
					<option value="audit">Audit</option>
					<option value="upgrade">Upgrade</option>
					<option value="home-energy-score">Home Energy Score</option>
				</select>
				<label for="xmlGeneratedBy">Generated By</label>
				<input type="text" id="xmlGeneratedBy">
				<label for="createdDateTime">Created Date/Time</label>
				<input type="datetime-local" id="createdDateTime">
				<label for="schemaVersion">Schema Version</label>
				<input type="text" id="schemaVersion" value="4.0" readonly>
				<label for="dataSource">Data Source</label>
				<select id="dataSource">
					<option value="software">Software</option>
					<option value="user">User</option>
				</select>
			</div>

			<div class="section-header">Customer Information</div>
			<div class="form-group">
				<label for="firstName">First Name</label>
				<input type="text" id="firstName">
				<label for="lastName">Last Name</label>
				<input type="text" id="lastName">
				<label for="email">Email</label>
				<input type="email" id="email">
				<label for="phone">Phone</label>
				<input type="tel" id="phone">
			</div>

			<div class="section-header">Building Site</div>
			<div class="form-group">
				<label for="address1">Address 1</label>
				<input type="text" id="address1">
				<label for="address2">Address 2</label>
				<input type="text" id="address2">
				<label for="city">City</label>
				<input type="text" id="city">
				<label for="state">State</label>
				<input type="text" id="state">
				<label for="zipCode">Zip Code</label>
				<input type="text" id="zipCode">
			</div>

			<div class="section-header">Building Details</div>
			<div class="form-group">
				<label for="buildingType">Building Type</label>
				<select id="buildingType">
					<option value="single-family detached">Single-family Detached</option>
					<option value="single-family attached">Single-family Attached</option>
					<option value="manufactured home">Manufactured Home</option>
					<option value="2-4 unit building">2-4 Unit Building</option>
				</select>
				<label for="yearBuilt">Year Built</label>
				<input type="number" id="yearBuilt">
				<label for="conditionedFloorArea">Conditioned Floor Area (sq ft)</label>
				<input type="number" id="conditionedFloorArea">
				<label for="numberOfStories">Number of Stories</label>
				<input type="number" id="numberOfStories">
				<label for="buildingVolume">Building Volume (cu ft)</label>
				<input type="number" id="buildingVolume">
				<label for="numberOfResidents">Number of Residents</label>
				<input type="number" id="numberOfResidents">
			</div>

			<div class="section-header">Air Infiltration</div>
			<div class="form-group">
				<label for="blowerDoorTest">Blower Door Test Type</label>
				<select id="blowerDoorTest">
					<option value="depressurization">Depressurization</option>
					<option value="pressurization">Pressurization</option>
				</select>
				<label for="housePressure">House Pressure (Pa)</label>
				<input type="number" id="housePressure">
				<label for="airLeakage">Air Leakage (CFM)</label>
				<input type="number" id="airLeakage">
				<label for="airLeakageUnit">Air Leakage Unit</label>
				<select id="airLeakageUnit">
					<option value="CFM">CFM</option>
					<option value="CFM25">CFM25</option>
					<option value="CFM50">CFM50</option>
				</select>
			</div>

			<div class="section-header">Attic</div>
			<div class="form-group">
				<label for="atticType">Attic Type</label>
				<select id="atticType">
					<option value="vented">Vented</option>
					<option value="unvented">Unvented</option>
				</select>
				<label for="atticInsulationType">Insulation Type</label>
				<select id="atticInsulationType">
					<option value="fiberglass">Fiberglass</option>
					<option value="cellulose">Cellulose</option>
					<option value="none">None</option>
				</select>
				<label for="atticInsulationRValue">Insulation R-Value</label>
				<input type="number" id="atticInsulationRValue">
			</div>

			<div class="section-header">HVAC Systems</div>
			<div class="form-group">
				<label for="heatingSystemType">Heating System Type</label>
				<select id="heatingSystemType">
					<option value="Furnace">Furnace</option>
					<option value="Boiler">Boiler</option>
					<option value="Heat Pump">Heat Pump</option>
				</select>
				<label for="heatingFuel">Heating Fuel</label>
				<select id="heatingFuel">
					<option value="natural gas">Natural Gas</option>
					<option value="electricity">Electricity</option>
					<option value="fuel oil">Fuel Oil</option>
					<option value="propane">Propane</option>
				</select>
				<label for="heatingEfficiency">Heating Efficiency (AFUE)</label>
				<input type="number" step="0.01" id="heatingEfficiency">
				<label for="heatingCapacity">Heating Capacity (BTU/h)</label>
				<input type="number" id="heatingCapacity">
			</div>

			<div class="form-group">
				<label for="coolingSystemType">Cooling System Type</label>
				<select id="coolingSystemType">
					<option value="central air conditioner">Central Air Conditioner</option>
					<option value="heat pump">Heat Pump</option>
					<option value="room air conditioner">Room Air Conditioner</option>
				</select>
				<label for="coolingEfficiency">Cooling Efficiency (SEER)</label>
				<input type="number" step="0.1" id="coolingEfficiency">
				<label for="coolingCapacity">Cooling Capacity (BTU/h)</label>
				<input type="number" id="coolingCapacity">
			</div>

			<div class="section-header">Water Heating</div>
			<div class="form-group">
				<label for="waterHeaterType">Water Heater Type</label>
				<select id="waterHeaterType">
					<option value="storage water heater">Storage Water Heater</option>
					<option value="tankless">Tankless</option>
					<option value="heat pump water heater">Heat Pump Water Heater</option>
					<option value="dedicated boiler with storage tank">Dedicated Boiler with Storage Tank</option>
				</select>
				<label for="waterHeaterFuel">Fuel Type</label>
				<select id="waterHeaterFuel">
					<option value="natural gas">Natural Gas</option>
					<option value="electricity">Electricity</option>
					<option value="fuel oil">Fuel Oil</option>
					<option value="propane">Propane</option>
				</select>
				<label for="waterHeaterEfficiency">Energy Factor</label>
				<input type="number" step="0.01" id="waterHeaterEfficiency">
				<label for="tankVolume">Tank Volume (gallons)</label>
				<input type="number" id="tankVolume">
				<label for="recoveryEfficiency">Recovery Efficiency</label>
				<input type="number" step="0.01" id="recoveryEfficiency">
			</div>

			<div class="section-header">Project Status</div>
			<div class="form-group">
				<label for="eventType">Event Type</label>
				<select id="eventType">
					<option value="audit">Audit</option>
					<option value="proposed workscope">Proposed Workscope</option>
					<option value="job completion testing/final inspection">Job Completion Testing/Final Inspection</option>
				</select>
			</div>

			<button class="button" onclick="generateXML()">Generate HPXML</button>
			<button class="button" onclick="validateXML()">Validate HPXML</button>
			<button class="button" onclick="downloadXML()">Download XML</button>
		</div>
	</div>

    <script>
      		const fileInput = document.getElementById('fileInput');
      		const editorSection = document.getElementById('editorSection');

      		fileInput.addEventListener('change', handleFileSelect);

      		function handleFileSelect(event) {
      			const file = event.target.files[0];
      			if (file) {
      				const reader = new FileReader();
      				reader.onload = function(e) {
      					populateFormFromXML(e.target.result);
      					editorSection.style.display = 'block';
      				};
      				reader.readAsText(file);
      			}
      		}

      		function populateFormFromXML(xmlString) {
      			const parser = new DOMParser();
      			const xmlDoc = parser.parseFromString(xmlString, 'text/xml');
      			// Add code to populate form fields from XML
      		}

      function populateFormFromXML(xmlString) {
      	const parser = new DOMParser();
      	const xmlDoc = parser.parseFromString(xmlString, 'text/xml');

      	// XML Transaction Header
      	document.getElementById('xmlType').value = getElementValue(xmlDoc, 'XMLType');
      	document.getElementById('xmlGeneratedBy').value = getElementValue(xmlDoc, 'XMLGeneratedBy');
      	document.getElementById('createdDateTime').value = getElementValue(xmlDoc, 'CreatedDateAndTime').split('.')[0];

      	// Customer Information
      	document.getElementById('firstName').value = getElementValue(xmlDoc, 'FirstName');
      	document.getElementById('lastName').value = getElementValue(xmlDoc, 'LastName');

      	// Building Site
      	document.getElementById('address1').value = getElementValue(xmlDoc, 'Address1');
      	document.getElementById('address2').value = getElementValue(xmlDoc, 'Address2');
      	document.getElementById('city').value = getElementValue(xmlDoc, 'CityMunicipality');
      	document.getElementById('state').value = getElementValue(xmlDoc, 'StateCode');
      	document.getElementById('zipCode').value = getElementValue(xmlDoc, 'ZipCode');

      	// Building Details
      	document.getElementById('buildingType').value = getElementValue(xmlDoc, 'ResidentialFacilityType');
      	document.getElementById('yearBuilt').value = getElementValue(xmlDoc, 'YearBuilt');
      	document.getElementById('conditionedFloorArea').value = getElementValue(xmlDoc, 'ConditionedFloorArea');

      	// Air Infiltration
      	document.getElementById('blowerDoorTest').value = getElementValue(xmlDoc, 'TypeOfBlowerDoorTest');
      	document.getElementById('housePressure').value = getElementValue(xmlDoc, 'HousePressure');
      	document.getElementById('airLeakage').value = getElementValue(xmlDoc, 'AirLeakage');

      	// HVAC Systems
      	document.getElementById('heatingSystemType').value = getElementValue(xmlDoc, 'HeatingSystemType');
      	document.getElementById('heatingFuel').value = getElementValue(xmlDoc, 'HeatingSystemFuel');
      	document.getElementById('heatingEfficiency').value = getElementValue(xmlDoc, 'Value');

      	document.getElementById('coolingSystemType').value = getElementValue(xmlDoc, 'CoolingSystemType');
      	document.getElementById('coolingEfficiency').value = getElementValue(xmlDoc, 'Value');

      	// Water Heating
      	document.getElementById('waterHeaterType').value = getElementValue(xmlDoc, 'WaterHeaterType');
      	document.getElementById('waterHeaterFuel').value = getElementValue(xmlDoc, 'FuelType');
      	document.getElementById('waterHeaterEfficiency').value = getElementValue(xmlDoc, 'EnergyFactor');
      }

      function generateXML() {
      	const xmlTemplate = `<?xml version="1.0" encoding="UTF-8"?>
      	<HPXML xmlns="http://hpxmlonline.com/2023/09" schemaVersion="4.0">
      		<XMLTransactionHeaderInformation>
      			<XMLType>${document.getElementById('xmlType').value}</XMLType>
      			<XMLGeneratedBy>${document.getElementById('xmlGeneratedBy').value}</XMLGeneratedBy>
      			<CreatedDateAndTime>${document.getElementById('createdDateTime').value}</CreatedDateAndTime>
      			<Transaction>create</Transaction>
      		</XMLTransactionHeaderInformation>
      		<Customer>
      			<CustomerDetails>
      				<Person>
      					<SystemIdentifier id="customer1"/>
      					<Name>
      						<FirstName>${document.getElementById('firstName').value}</FirstName>
      						<LastName>${document.getElementById('lastName').value}</LastName>
      					</Name>
      				</Person>
      			</CustomerDetails>
      		</Customer>
      		<Building>
      			<BuildingID id="bldg1"/>
      			<Site>
      				<Address>
      					<Address1>${document.getElementById('address1').value}</Address1>
      					<Address2>${document.getElementById('address2').value}</Address2>
      					<CityMunicipality>${document.getElementById('city').value}</CityMunicipality>
      					<StateCode>${document.getElementById('state').value}</StateCode>
      					<ZipCode>${document.getElementById('zipCode').value}</ZipCode>
      				</Address>
      			</Site>
      			<BuildingDetails>
      				<BuildingSummary>
      					<BuildingConstruction>
      						<YearBuilt>${document.getElementById('yearBuilt').value}</YearBuilt>
      						<ResidentialFacilityType>${document.getElementById('buildingType').value}</ResidentialFacilityType>
      						<ConditionedFloorArea>${document.getElementById('conditionedFloorArea').value}</ConditionedFloorArea>
      					</BuildingConstruction>
      				</BuildingSummary>
      				<Systems>
      					<HVAC>
      						<HVACPlant>
      							<HeatingSystem>
      								<HeatingSystemType>${document.getElementById('heatingSystemType').value}</HeatingSystemType>
      								<HeatingSystemFuel>${document.getElementById('heatingFuel').value}</HeatingSystemFuel>
      								<AnnualHeatingEfficiency>
      									<Units>AFUE</Units>
      									<Value>${document.getElementById('heatingEfficiency').value}</Value>
      								</AnnualHeatingEfficiency>
      							</HeatingSystem>
      							<CoolingSystem>
      								<CoolingSystemType>${document.getElementById('coolingSystemType').value}</CoolingSystemType>
      								<AnnualCoolingEfficiency>
      									<Units>SEER</Units>
      									<Value>${document.getElementById('coolingEfficiency').value}</Value>
      								</AnnualCoolingEfficiency>
      							</CoolingSystem>
      						</HVACPlant>
      					</HVAC>
      					<WaterHeating>
      						<WaterHeatingSystem>
      							<SystemIdentifier id="dhw1"/>
      							<WaterHeaterType>${document.getElementById('waterHeaterType').value}</WaterHeaterType>
      							<FuelType>${document.getElementById('waterHeaterFuel').value}</FuelType>
      							<EnergyFactor>${document.getElementById('waterHeaterEfficiency').value}</EnergyFactor>
      						</WaterHeatingSystem>
      					</WaterHeating>
      				</Systems>
      			</BuildingDetails>
      		</Building>
      	</HPXML>`;

      	return xmlTemplate;
      }

      function getElementValue(xmlDoc, tagName) {
      	const element = xmlDoc.getElementsByTagName(tagName)[0];
      	return element ? element.textContent : '';
      }

      		function downloadXML() {
      			const xmlString = generateXML();
      			const blob = new Blob([xmlString], {type: 'text/xml'});
      			const url = window.URL.createObjectURL(blob);
      			const a = document.createElement('a');
      			a.href = url;
      			a.download = 'hpxml_file.xml';
      			a.click();
      			window.URL.revokeObjectURL(url);
      		}
    </script>
  </body>
</html>
